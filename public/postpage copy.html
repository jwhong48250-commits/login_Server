<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Post 페이지</title>
    <script>
      function loaddata() {
        const API_URL = "http://127.0.0.1:8080/post";
        const token = localStorage.getItem("token");

        async function fetchPostsWithAuth() {
          try {
            debugger;
            const response = await fetch(API_URL, {
              method: "GET",
              headers: {
                Authorization: `Bearer ${token}`,

                "Content-Type": "application/json",
              },
            });

            if (!response.ok) {
              throw new Error(`HTTP Error! Status: ${response.status}`);
            }

            const data = await response.json();
            debugger;
            console.log("가져온 포스트 데이터:", data);
            console.log(JSON.stringify(data));
            let Html = "";

            const rows = data.postList.row;
            for (let i = 0; i < rows.length; i++) {
              Html += `<div>${rows[i].name} + "<br>" + ${rows[i].post} + "<br>"</div>`;
              document.getElementById("Info").innerHTML = Html;
            }
            document.getElementById("Info").innerHTML = Html;
          } catch (error) {
            console.error("데이터를 가져오는 중 오류 발생:", error);
            document.getElementById(
              "Info"
            ).innerHTML = `<p style="color: red;">데이터를 불러오지 못했습니다: ${error.message}</p>`;
          }
        }
        fetchPostsWithAuth();
      }
    </script>
  </head>
  <body>
    <h1>포스트 리스트</h1>
    <div id="Info"></div>
  </body>
</html>
